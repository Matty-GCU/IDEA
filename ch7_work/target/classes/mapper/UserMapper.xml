<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="dao.UserDao">
	<!-- 一对一查询，使用pojo存储结果 -->
		<select id="selectUserById" parameterType="Integer" resultType="pojo.SelectUserById">
			select u.*, bc.code
			from user u, borrowercard bc
			where u.uid = bc.id and u.uid=#{uid}
		</select>
		
		<!-- 多对多 -->
		<resultMap type="po.User" id="allUserAndBook">
			<id property="uid" column="uid"/>
			<result property="uname" column="uname"/>
			<!-- 多对多级联 -->
				<collection property="books" ofType="po.Book" javaType="java.util.List">
					<id property="id" column="id"/>
					<result property="name" column="name"/>
					<result property="price" column="price"/>
					<result property="author" column="author"/>
					<result property="number" column="number"/>
					<result property="bname" column="bname"/>
				</collection>
		</resultMap>
		<select id="selectallUserAndBook" resultMap="allUserAndBook">
			select u.*, b.id, b.name, b.price, b.author, b.number
			from user u, book b, borrowerlist bl
			where bl.user_id = u.uid and bl.book_id = b.id
		</select>
</mapper>